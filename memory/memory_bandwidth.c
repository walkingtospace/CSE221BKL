#include "cpu_test.h"
#include "math.h"

void rambw_read_test(int iteration, data_t ccnt_overhead) {
	const int SIZE = 10*1024*1024; //10MB
	const int STRIDE = 4096;
	float mean = 0, std = 0, min = 99999999, max = 0, median = 0;
	float result[iteration/1000];	

	// Set up array
	int* v = (int*)malloc(sizeof(int)*SIZE);
	int i, cnt = 0;

	for (i = STRIDE; i < SIZE; i += STRIDE) {
		v[i] = (int)&v[i-STRIDE];
	}

	v[0] = (int)&v[i-STRIDE];

	// Warmup
	int* p = v;
	do {
		p = (int*)*p;
	} while (p != (int*)v);

	// Get result
	data_t t0, t1;
	float sum_t = 0;
	int n = 0;
	int tmp;
	const int step = 1000;
	int* u = v;

	for (i = 0; i < iteration; i += step) {
		t0 = ccnt_read();
		
		tmp = u[0] + u[16] + u[32] + u[48] + u[64] + u[80] + u[96] + u[112] + u[128] + u[144] + 
			u[160] + u[176] + u[192] + u[208] + u[224] + u[240] + u[256] + u[272] + u[288] + u[304] + 
			u[320] + u[336] + u[352] + u[368] + u[384] + u[400] + u[416] + u[432] + u[448] + u[464] + 
			u[480] + u[496] + u[512] + u[528] + u[544] + u[560] + u[576] + u[592] + u[608] + u[624] + 
			u[640] + u[656] + u[672] + u[688] + u[704] + u[720] + u[736] + u[752] + u[768] + u[784] + 
			u[800] + u[816] + u[832] + u[848] + u[864] + u[880] + u[896] + u[912] + u[928] + u[944] + 
			u[960] + u[976] + u[992] + u[1008] + u[1024] + u[1040] + u[1056] + u[1072] + u[1088] + u[1104] + 
			u[1120] + u[1136] + u[1152] + u[1168] + u[1184] + u[1200] + u[1216] + u[1232] + u[1248] + u[1264] + 
			u[1280] + u[1296] + u[1312] + u[1328] + u[1344] + u[1360] + u[1376] + u[1392] + u[1408] + u[1424] + 
			u[1440] + u[1456] + u[1472] + u[1488] + u[1504] + u[1520] + u[1536] + u[1552] + u[1568] + u[1584] + 
			u[1600] + u[1616] + u[1632] + u[1648] + u[1664] + u[1680] + u[1696] + u[1712] + u[1728] + u[1744] + 
			u[1760] + u[1776] + u[1792] + u[1808] + u[1824] + u[1840] + u[1856] + u[1872] + u[1888] + u[1904] + 
			u[1920] + u[1936] + u[1952] + u[1968] + u[1984] + u[2000] + u[2016] + u[2032] + u[2048] + u[2064] + 
			u[2080] + u[2096] + u[2112] + u[2128] + u[2144] + u[2160] + u[2176] + u[2192] + u[2208] + u[2224] + 
			u[2240] + u[2256] + u[2272] + u[2288] + u[2304] + u[2320] + u[2336] + u[2352] + u[2368] + u[2384] + 
			u[2400] + u[2416] + u[2432] + u[2448] + u[2464] + u[2480] + u[2496] + u[2512] + u[2528] + u[2544] + 
			u[2560] + u[2576] + u[2592] + u[2608] + u[2624] + u[2640] + u[2656] + u[2672] + u[2688] + u[2704] + 
			u[2720] + u[2736] + u[2752] + u[2768] + u[2784] + u[2800] + u[2816] + u[2832] + u[2848] + u[2864] + 
			u[2880] + u[2896] + u[2912] + u[2928] + u[2944] + u[2960] + u[2976] + u[2992] + u[3008] + u[3024] + 
			u[3040] + u[3056] + u[3072] + u[3088] + u[3104] + u[3120] + u[3136] + u[3152] + u[3168] + u[3184] + 
			u[3200] + u[3216] + u[3232] + u[3248] + u[3264] + u[3280] + u[3296] + u[3312] + u[3328] + u[3344] + 
			u[3360] + u[3376] + u[3392] + u[3408] + u[3424] + u[3440] + u[3456] + u[3472] + u[3488] + u[3504] + 
			u[3520] + u[3536] + u[3552] + u[3568] + u[3584] + u[3600] + u[3616] + u[3632] + u[3648] + u[3664] + 
			u[3680] + u[3696] + u[3712] + u[3728] + u[3744] + u[3760] + u[3776] + u[3792] + u[3808] + u[3824] + 
			u[3840] + u[3856] + u[3872] + u[3888] + u[3904] + u[3920] + u[3936] + u[3952] + u[3968] + u[3984] + 
			u[4000] + u[4016] + u[4032] + u[4048] + u[4064] + u[4080] + u[4096] + u[4112] + u[4128] + u[4144] + 
			u[4160] + u[4176] + u[4192] + u[4208] + u[4224] + u[4240] + u[4256] + u[4272] + u[4288] + u[4304] + 
			u[4320] + u[4336] + u[4352] + u[4368] + u[4384] + u[4400] + u[4416] + u[4432] + u[4448] + u[4464] + 
			u[4480] + u[4496] + u[4512] + u[4528] + u[4544] + u[4560] + u[4576] + u[4592] + u[4608] + u[4624] + 
			u[4640] + u[4656] + u[4672] + u[4688] + u[4704] + u[4720] + u[4736] + u[4752] + u[4768] + u[4784] + 
			u[4800] + u[4816] + u[4832] + u[4848] + u[4864] + u[4880] + u[4896] + u[4912] + u[4928] + u[4944] + 
			u[4960] + u[4976] + u[4992] + u[5008] + u[5024] + u[5040] + u[5056] + u[5072] + u[5088] + u[5104] + 
			u[5120] + u[5136] + u[5152] + u[5168] + u[5184] + u[5200] + u[5216] + u[5232] + u[5248] + u[5264] + 
			u[5280] + u[5296] + u[5312] + u[5328] + u[5344] + u[5360] + u[5376] + u[5392] + u[5408] + u[5424] + 
			u[5440] + u[5456] + u[5472] + u[5488] + u[5504] + u[5520] + u[5536] + u[5552] + u[5568] + u[5584] + 
			u[5600] + u[5616] + u[5632] + u[5648] + u[5664] + u[5680] + u[5696] + u[5712] + u[5728] + u[5744] + 
			u[5760] + u[5776] + u[5792] + u[5808] + u[5824] + u[5840] + u[5856] + u[5872] + u[5888] + u[5904] + 
			u[5920] + u[5936] + u[5952] + u[5968] + u[5984] + u[6000] + u[6016] + u[6032] + u[6048] + u[6064] + 
			u[6080] + u[6096] + u[6112] + u[6128] + u[6144] + u[6160] + u[6176] + u[6192] + u[6208] + u[6224] + 
			u[6240] + u[6256] + u[6272] + u[6288] + u[6304] + u[6320] + u[6336] + u[6352] + u[6368] + u[6384] + 
			u[6400] + u[6416] + u[6432] + u[6448] + u[6464] + u[6480] + u[6496] + u[6512] + u[6528] + u[6544] + 
			u[6560] + u[6576] + u[6592] + u[6608] + u[6624] + u[6640] + u[6656] + u[6672] + u[6688] + u[6704] + 
			u[6720] + u[6736] + u[6752] + u[6768] + u[6784] + u[6800] + u[6816] + u[6832] + u[6848] + u[6864] + 
			u[6880] + u[6896] + u[6912] + u[6928] + u[6944] + u[6960] + u[6976] + u[6992] + u[7008] + u[7024] + 
			u[7040] + u[7056] + u[7072] + u[7088] + u[7104] + u[7120] + u[7136] + u[7152] + u[7168] + u[7184] + 
			u[7200] + u[7216] + u[7232] + u[7248] + u[7264] + u[7280] + u[7296] + u[7312] + u[7328] + u[7344] + 
			u[7360] + u[7376] + u[7392] + u[7408] + u[7424] + u[7440] + u[7456] + u[7472] + u[7488] + u[7504] + 
			u[7520] + u[7536] + u[7552] + u[7568] + u[7584] + u[7600] + u[7616] + u[7632] + u[7648] + u[7664] + 
			u[7680] + u[7696] + u[7712] + u[7728] + u[7744] + u[7760] + u[7776] + u[7792] + u[7808] + u[7824] + 
			u[7840] + u[7856] + u[7872] + u[7888] + u[7904] + u[7920] + u[7936] + u[7952] + u[7968] + u[7984] + 
			u[8000] + u[8016] + u[8032] + u[8048] + u[8064] + u[8080] + u[8096] + u[8112] + u[8128] + u[8144] + 
			u[8160] + u[8176] + u[8192] + u[8208] + u[8224] + u[8240] + u[8256] + u[8272] + u[8288] + u[8304] + 
			u[8320] + u[8336] + u[8352] + u[8368] + u[8384] + u[8400] + u[8416] + u[8432] + u[8448] + u[8464] + 
			u[8480] + u[8496] + u[8512] + u[8528] + u[8544] + u[8560] + u[8576] + u[8592] + u[8608] + u[8624] + 
			u[8640] + u[8656] + u[8672] + u[8688] + u[8704] + u[8720] + u[8736] + u[8752] + u[8768] + u[8784] + 
			u[8800] + u[8816] + u[8832] + u[8848] + u[8864] + u[8880] + u[8896] + u[8912] + u[8928] + u[8944] + 
			u[8960] + u[8976] + u[8992] + u[9008] + u[9024] + u[9040] + u[9056] + u[9072] + u[9088] + u[9104] + 
			u[9120] + u[9136] + u[9152] + u[9168] + u[9184] + u[9200] + u[9216] + u[9232] + u[9248] + u[9264] + 
			u[9280] + u[9296] + u[9312] + u[9328] + u[9344] + u[9360] + u[9376] + u[9392] + u[9408] + u[9424] + 
			u[9440] + u[9456] + u[9472] + u[9488] + u[9504] + u[9520] + u[9536] + u[9552] + u[9568] + u[9584] + 
			u[9600] + u[9616] + u[9632] + u[9648] + u[9664] + u[9680] + u[9696] + u[9712] + u[9728] + u[9744] + 
			u[9760] + u[9776] + u[9792] + u[9808] + u[9824] + u[9840] + u[9856] + u[9872] + u[9888] + u[9904] + 
			u[9920] + u[9936] + u[9952] + u[9968] + u[9984] + u[10000] + u[10016] + u[10032] + u[10048] + u[10064] + 
			u[10080] + u[10096] + u[10112] + u[10128] + u[10144] + u[10160] + u[10176] + u[10192] + u[10208] + u[10224] + 
			u[10240] + u[10256] + u[10272] + u[10288] + u[10304] + u[10320] + u[10336] + u[10352] + u[10368] + u[10384] + 
			u[10400] + u[10416] + u[10432] + u[10448] + u[10464] + u[10480] + u[10496] + u[10512] + u[10528] + u[10544] + 
			u[10560] + u[10576] + u[10592] + u[10608] + u[10624] + u[10640] + u[10656] + u[10672] + u[10688] + u[10704] + 
			u[10720] + u[10736] + u[10752] + u[10768] + u[10784] + u[10800] + u[10816] + u[10832] + u[10848] + u[10864] + 
			u[10880] + u[10896] + u[10912] + u[10928] + u[10944] + u[10960] + u[10976] + u[10992] + u[11008] + u[11024] + 
			u[11040] + u[11056] + u[11072] + u[11088] + u[11104] + u[11120] + u[11136] + u[11152] + u[11168] + u[11184] + 
			u[11200] + u[11216] + u[11232] + u[11248] + u[11264] + u[11280] + u[11296] + u[11312] + u[11328] + u[11344] + 
			u[11360] + u[11376] + u[11392] + u[11408] + u[11424] + u[11440] + u[11456] + u[11472] + u[11488] + u[11504] + 
			u[11520] + u[11536] + u[11552] + u[11568] + u[11584] + u[11600] + u[11616] + u[11632] + u[11648] + u[11664] + 
			u[11680] + u[11696] + u[11712] + u[11728] + u[11744] + u[11760] + u[11776] + u[11792] + u[11808] + u[11824] + 
			u[11840] + u[11856] + u[11872] + u[11888] + u[11904] + u[11920] + u[11936] + u[11952] + u[11968] + u[11984] + 
			u[12000] + u[12016] + u[12032] + u[12048] + u[12064] + u[12080] + u[12096] + u[12112] + u[12128] + u[12144] + 
			u[12160] + u[12176] + u[12192] + u[12208] + u[12224] + u[12240] + u[12256] + u[12272] + u[12288] + u[12304] + 
			u[12320] + u[12336] + u[12352] + u[12368] + u[12384] + u[12400] + u[12416] + u[12432] + u[12448] + u[12464] + 
			u[12480] + u[12496] + u[12512] + u[12528] + u[12544] + u[12560] + u[12576] + u[12592] + u[12608] + u[12624] + 
			u[12640] + u[12656] + u[12672] + u[12688] + u[12704] + u[12720] + u[12736] + u[12752] + u[12768] + u[12784] + 
			u[12800] + u[12816] + u[12832] + u[12848] + u[12864] + u[12880] + u[12896] + u[12912] + u[12928] + u[12944] + 
			u[12960] + u[12976] + u[12992] + u[13008] + u[13024] + u[13040] + u[13056] + u[13072] + u[13088] + u[13104] + 
			u[13120] + u[13136] + u[13152] + u[13168] + u[13184] + u[13200] + u[13216] + u[13232] + u[13248] + u[13264] + 
			u[13280] + u[13296] + u[13312] + u[13328] + u[13344] + u[13360] + u[13376] + u[13392] + u[13408] + u[13424] + 
			u[13440] + u[13456] + u[13472] + u[13488] + u[13504] + u[13520] + u[13536] + u[13552] + u[13568] + u[13584] + 
			u[13600] + u[13616] + u[13632] + u[13648] + u[13664] + u[13680] + u[13696] + u[13712] + u[13728] + u[13744] + 
			u[13760] + u[13776] + u[13792] + u[13808] + u[13824] + u[13840] + u[13856] + u[13872] + u[13888] + u[13904] + 
			u[13920] + u[13936] + u[13952] + u[13968] + u[13984] + u[14000] + u[14016] + u[14032] + u[14048] + u[14064] + 
			u[14080] + u[14096] + u[14112] + u[14128] + u[14144] + u[14160] + u[14176] + u[14192] + u[14208] + u[14224] + 
			u[14240] + u[14256] + u[14272] + u[14288] + u[14304] + u[14320] + u[14336] + u[14352] + u[14368] + u[14384] + 
			u[14400] + u[14416] + u[14432] + u[14448] + u[14464] + u[14480] + u[14496] + u[14512] + u[14528] + u[14544] + 
			u[14560] + u[14576] + u[14592] + u[14608] + u[14624] + u[14640] + u[14656] + u[14672] + u[14688] + u[14704] + 
			u[14720] + u[14736] + u[14752] + u[14768] + u[14784] + u[14800] + u[14816] + u[14832] + u[14848] + u[14864] + 
			u[14880] + u[14896] + u[14912] + u[14928] + u[14944] + u[14960] + u[14976] + u[14992] + u[15008] + u[15024] + 
			u[15040] + u[15056] + u[15072] + u[15088] + u[15104] + u[15120] + u[15136] + u[15152] + u[15168] + u[15184] + 
			u[15200] + u[15216] + u[15232] + u[15248] + u[15264] + u[15280] + u[15296] + u[15312] + u[15328] + u[15344] + 
			u[15360] + u[15376] + u[15392] + u[15408] + u[15424] + u[15440] + u[15456] + u[15472] + u[15488] + u[15504] + 
			u[15520] + u[15536] + u[15552] + u[15568] + u[15584] + u[15600] + u[15616] + u[15632] + u[15648] + u[15664] + 
			u[15680] + u[15696] + u[15712] + u[15728] + u[15744] + u[15760] + u[15776] + u[15792] + u[15808] + u[15824] + 
			u[15840] + u[15856] + u[15872] + u[15888] + u[15904] + u[15920] + u[15936] + u[15952] + u[15968] + u[15984];

		t1 = ccnt_read();
		
		//printf("MEM\t%d\t%d\t%d\n", t1-t0, sizeof(int)*SIZE, STRIDE);
		n += step;
		float temp = (t1 - t0 - ccnt_overhead); 
		sum_t += temp;
		u += 15984 + 16;

		if (u >= &v[SIZE - 15984])
			u = v;
	
		if(temp < 0) printf("negative!");

		result[cnt++] = temp;

		if(min > temp) {
			min = temp;
		} 	

		if(max < temp) {
			max = temp;
		}
	}

	for(int i = 0; i < cnt ; ++i) {
		for(int j = i; j < cnt ; ++j) {
			if(result[i] > result[j]) {
				float temp = result[i];
				result[i] = result[j];
				result[j] = temp;	
			}
		}

		std += pow((result[i] - mean), 2);
	}

	median = result[cnt/2];
	mean = (sum_t/cnt);
	std /= (cnt);	
	
	printf("mean : %f \n", mean);
	printf("median : %f \n", median);
	printf("max : %f \n", max);
	printf("min : %f \n", min);
	printf("std : %f \n", sqrt(std));

	printf("BW_RD_AVG\t%d(MB/S)\t%d\t%d\n", (int)((n * sizeof(int) ) / ((0.00000000142*(float)sum_t*1024*1024))), sizeof(int)*SIZE, STRIDE);

	free(v);
}


void rambw_write_test(int iteration, data_t overhead) {
	const int SIZE = 10*1024*1024;
	const int STRIDE = 4096;
	float mean = 0, std = 0, min = 99999999, max = 0, median = 0;
	float result[iteration/1000];	

	// Set up array
	int* v = (int*)malloc(sizeof(int)*SIZE);
	int i, cnt = 0;
	for (i = STRIDE; i < SIZE; i += STRIDE) {
		v[i] = (int)&v[i-STRIDE];
	}
	v[0] = (int)&v[i-STRIDE];

	// Warmup
	int* p = v;
	do {
		p = (int*)*p;
	} while (p != (int*)v);

	// Get result
	int t0, t1;
	long long sum_t = 0;
	int n = 0;

	const int step = 1000;
	int* u = v;


	for (i = 0; i < iteration; i += step) {
		t0 = ccnt_read();

		u[0] = 1; u[16] = 1; u[32] = 1; u[48] = 1; u[64] = 1; u[80] = 1; u[96] = 1; u[112] = 1; u[128] = 1; u[144] = 1; 
		u[160] = 1; u[176] = 1; u[192] = 1; u[208] = 1; u[224] = 1; u[240] = 1; u[256] = 1; u[272] = 1; u[288] = 1; u[304] = 1; 
		u[320] = 1; u[336] = 1; u[352] = 1; u[368] = 1; u[384] = 1; u[400] = 1; u[416] = 1; u[432] = 1; u[448] = 1; u[464] = 1; 
		u[480] = 1; u[496] = 1; u[512] = 1; u[528] = 1; u[544] = 1; u[560] = 1; u[576] = 1; u[592] = 1; u[608] = 1; u[624] = 1; 
		u[640] = 1; u[656] = 1; u[672] = 1; u[688] = 1; u[704] = 1; u[720] = 1; u[736] = 1; u[752] = 1; u[768] = 1; u[784] = 1; 
		u[800] = 1; u[816] = 1; u[832] = 1; u[848] = 1; u[864] = 1; u[880] = 1; u[896] = 1; u[912] = 1; u[928] = 1; u[944] = 1; 
		u[960] = 1; u[976] = 1; u[992] = 1; u[1008] = 1; u[1024] = 1; u[1040] = 1; u[1056] = 1; u[1072] = 1; u[1088] = 1; u[1104] = 1; 
		u[1120] = 1; u[1136] = 1; u[1152] = 1; u[1168] = 1; u[1184] = 1; u[1200] = 1; u[1216] = 1; u[1232] = 1; u[1248] = 1; u[1264] = 1; 
		u[1280] = 1; u[1296] = 1; u[1312] = 1; u[1328] = 1; u[1344] = 1; u[1360] = 1; u[1376] = 1; u[1392] = 1; u[1408] = 1; u[1424] = 1; 
		u[1440] = 1; u[1456] = 1; u[1472] = 1; u[1488] = 1; u[1504] = 1; u[1520] = 1; u[1536] = 1; u[1552] = 1; u[1568] = 1; u[1584] = 1; 
		u[1600] = 1; u[1616] = 1; u[1632] = 1; u[1648] = 1; u[1664] = 1; u[1680] = 1; u[1696] = 1; u[1712] = 1; u[1728] = 1; u[1744] = 1; 
		u[1760] = 1; u[1776] = 1; u[1792] = 1; u[1808] = 1; u[1824] = 1; u[1840] = 1; u[1856] = 1; u[1872] = 1; u[1888] = 1; u[1904] = 1; 
		u[1920] = 1; u[1936] = 1; u[1952] = 1; u[1968] = 1; u[1984] = 1; u[2000] = 1; u[2016] = 1; u[2032] = 1; u[2048] = 1; u[2064] = 1; 
		u[2080] = 1; u[2096] = 1; u[2112] = 1; u[2128] = 1; u[2144] = 1; u[2160] = 1; u[2176] = 1; u[2192] = 1; u[2208] = 1; u[2224] = 1; 
		u[2240] = 1; u[2256] = 1; u[2272] = 1; u[2288] = 1; u[2304] = 1; u[2320] = 1; u[2336] = 1; u[2352] = 1; u[2368] = 1; u[2384] = 1; 
		u[2400] = 1; u[2416] = 1; u[2432] = 1; u[2448] = 1; u[2464] = 1; u[2480] = 1; u[2496] = 1; u[2512] = 1; u[2528] = 1; u[2544] = 1; 
		u[2560] = 1; u[2576] = 1; u[2592] = 1; u[2608] = 1; u[2624] = 1; u[2640] = 1; u[2656] = 1; u[2672] = 1; u[2688] = 1; u[2704] = 1; 
		u[2720] = 1; u[2736] = 1; u[2752] = 1; u[2768] = 1; u[2784] = 1; u[2800] = 1; u[2816] = 1; u[2832] = 1; u[2848] = 1; u[2864] = 1; 
		u[2880] = 1; u[2896] = 1; u[2912] = 1; u[2928] = 1; u[2944] = 1; u[2960] = 1; u[2976] = 1; u[2992] = 1; u[3008] = 1; u[3024] = 1; 
		u[3040] = 1; u[3056] = 1; u[3072] = 1; u[3088] = 1; u[3104] = 1; u[3120] = 1; u[3136] = 1; u[3152] = 1; u[3168] = 1; u[3184] = 1; 
		u[3200] = 1; u[3216] = 1; u[3232] = 1; u[3248] = 1; u[3264] = 1; u[3280] = 1; u[3296] = 1; u[3312] = 1; u[3328] = 1; u[3344] = 1; 
		u[3360] = 1; u[3376] = 1; u[3392] = 1; u[3408] = 1; u[3424] = 1; u[3440] = 1; u[3456] = 1; u[3472] = 1; u[3488] = 1; u[3504] = 1; 
		u[3520] = 1; u[3536] = 1; u[3552] = 1; u[3568] = 1; u[3584] = 1; u[3600] = 1; u[3616] = 1; u[3632] = 1; u[3648] = 1; u[3664] = 1; 
		u[3680] = 1; u[3696] = 1; u[3712] = 1; u[3728] = 1; u[3744] = 1; u[3760] = 1; u[3776] = 1; u[3792] = 1; u[3808] = 1; u[3824] = 1; 
		u[3840] = 1; u[3856] = 1; u[3872] = 1; u[3888] = 1; u[3904] = 1; u[3920] = 1; u[3936] = 1; u[3952] = 1; u[3968] = 1; u[3984] = 1; 
		u[4000] = 1; u[4016] = 1; u[4032] = 1; u[4048] = 1; u[4064] = 1; u[4080] = 1; u[4096] = 1; u[4112] = 1; u[4128] = 1; u[4144] = 1; 
		u[4160] = 1; u[4176] = 1; u[4192] = 1; u[4208] = 1; u[4224] = 1; u[4240] = 1; u[4256] = 1; u[4272] = 1; u[4288] = 1; u[4304] = 1; 
		u[4320] = 1; u[4336] = 1; u[4352] = 1; u[4368] = 1; u[4384] = 1; u[4400] = 1; u[4416] = 1; u[4432] = 1; u[4448] = 1; u[4464] = 1; 
		u[4480] = 1; u[4496] = 1; u[4512] = 1; u[4528] = 1; u[4544] = 1; u[4560] = 1; u[4576] = 1; u[4592] = 1; u[4608] = 1; u[4624] = 1; 
		u[4640] = 1; u[4656] = 1; u[4672] = 1; u[4688] = 1; u[4704] = 1; u[4720] = 1; u[4736] = 1; u[4752] = 1; u[4768] = 1; u[4784] = 1; 
		u[4800] = 1; u[4816] = 1; u[4832] = 1; u[4848] = 1; u[4864] = 1; u[4880] = 1; u[4896] = 1; u[4912] = 1; u[4928] = 1; u[4944] = 1; 
		u[4960] = 1; u[4976] = 1; u[4992] = 1; u[5008] = 1; u[5024] = 1; u[5040] = 1; u[5056] = 1; u[5072] = 1; u[5088] = 1; u[5104] = 1; 
		u[5120] = 1; u[5136] = 1; u[5152] = 1; u[5168] = 1; u[5184] = 1; u[5200] = 1; u[5216] = 1; u[5232] = 1; u[5248] = 1; u[5264] = 1; 
		u[5280] = 1; u[5296] = 1; u[5312] = 1; u[5328] = 1; u[5344] = 1; u[5360] = 1; u[5376] = 1; u[5392] = 1; u[5408] = 1; u[5424] = 1; 
		u[5440] = 1; u[5456] = 1; u[5472] = 1; u[5488] = 1; u[5504] = 1; u[5520] = 1; u[5536] = 1; u[5552] = 1; u[5568] = 1; u[5584] = 1; 
		u[5600] = 1; u[5616] = 1; u[5632] = 1; u[5648] = 1; u[5664] = 1; u[5680] = 1; u[5696] = 1; u[5712] = 1; u[5728] = 1; u[5744] = 1; 
		u[5760] = 1; u[5776] = 1; u[5792] = 1; u[5808] = 1; u[5824] = 1; u[5840] = 1; u[5856] = 1; u[5872] = 1; u[5888] = 1; u[5904] = 1; 
		u[5920] = 1; u[5936] = 1; u[5952] = 1; u[5968] = 1; u[5984] = 1; u[6000] = 1; u[6016] = 1; u[6032] = 1; u[6048] = 1; u[6064] = 1; 
		u[6080] = 1; u[6096] = 1; u[6112] = 1; u[6128] = 1; u[6144] = 1; u[6160] = 1; u[6176] = 1; u[6192] = 1; u[6208] = 1; u[6224] = 1; 
		u[6240] = 1; u[6256] = 1; u[6272] = 1; u[6288] = 1; u[6304] = 1; u[6320] = 1; u[6336] = 1; u[6352] = 1; u[6368] = 1; u[6384] = 1; 
		u[6400] = 1; u[6416] = 1; u[6432] = 1; u[6448] = 1; u[6464] = 1; u[6480] = 1; u[6496] = 1; u[6512] = 1; u[6528] = 1; u[6544] = 1; 
		u[6560] = 1; u[6576] = 1; u[6592] = 1; u[6608] = 1; u[6624] = 1; u[6640] = 1; u[6656] = 1; u[6672] = 1; u[6688] = 1; u[6704] = 1; 
		u[6720] = 1; u[6736] = 1; u[6752] = 1; u[6768] = 1; u[6784] = 1; u[6800] = 1; u[6816] = 1; u[6832] = 1; u[6848] = 1; u[6864] = 1; 
		u[6880] = 1; u[6896] = 1; u[6912] = 1; u[6928] = 1; u[6944] = 1; u[6960] = 1; u[6976] = 1; u[6992] = 1; u[7008] = 1; u[7024] = 1; 
		u[7040] = 1; u[7056] = 1; u[7072] = 1; u[7088] = 1; u[7104] = 1; u[7120] = 1; u[7136] = 1; u[7152] = 1; u[7168] = 1; u[7184] = 1; 
		u[7200] = 1; u[7216] = 1; u[7232] = 1; u[7248] = 1; u[7264] = 1; u[7280] = 1; u[7296] = 1; u[7312] = 1; u[7328] = 1; u[7344] = 1; 
		u[7360] = 1; u[7376] = 1; u[7392] = 1; u[7408] = 1; u[7424] = 1; u[7440] = 1; u[7456] = 1; u[7472] = 1; u[7488] = 1; u[7504] = 1; 
		u[7520] = 1; u[7536] = 1; u[7552] = 1; u[7568] = 1; u[7584] = 1; u[7600] = 1; u[7616] = 1; u[7632] = 1; u[7648] = 1; u[7664] = 1; 
		u[7680] = 1; u[7696] = 1; u[7712] = 1; u[7728] = 1; u[7744] = 1; u[7760] = 1; u[7776] = 1; u[7792] = 1; u[7808] = 1; u[7824] = 1; 
		u[7840] = 1; u[7856] = 1; u[7872] = 1; u[7888] = 1; u[7904] = 1; u[7920] = 1; u[7936] = 1; u[7952] = 1; u[7968] = 1; u[7984] = 1; 
		u[8000] = 1; u[8016] = 1; u[8032] = 1; u[8048] = 1; u[8064] = 1; u[8080] = 1; u[8096] = 1; u[8112] = 1; u[8128] = 1; u[8144] = 1; 
		u[8160] = 1; u[8176] = 1; u[8192] = 1; u[8208] = 1; u[8224] = 1; u[8240] = 1; u[8256] = 1; u[8272] = 1; u[8288] = 1; u[8304] = 1; 
		u[8320] = 1; u[8336] = 1; u[8352] = 1; u[8368] = 1; u[8384] = 1; u[8400] = 1; u[8416] = 1; u[8432] = 1; u[8448] = 1; u[8464] = 1; 
		u[8480] = 1; u[8496] = 1; u[8512] = 1; u[8528] = 1; u[8544] = 1; u[8560] = 1; u[8576] = 1; u[8592] = 1; u[8608] = 1; u[8624] = 1; 
		u[8640] = 1; u[8656] = 1; u[8672] = 1; u[8688] = 1; u[8704] = 1; u[8720] = 1; u[8736] = 1; u[8752] = 1; u[8768] = 1; u[8784] = 1; 
		u[8800] = 1; u[8816] = 1; u[8832] = 1; u[8848] = 1; u[8864] = 1; u[8880] = 1; u[8896] = 1; u[8912] = 1; u[8928] = 1; u[8944] = 1; 
		u[8960] = 1; u[8976] = 1; u[8992] = 1; u[9008] = 1; u[9024] = 1; u[9040] = 1; u[9056] = 1; u[9072] = 1; u[9088] = 1; u[9104] = 1; 
		u[9120] = 1; u[9136] = 1; u[9152] = 1; u[9168] = 1; u[9184] = 1; u[9200] = 1; u[9216] = 1; u[9232] = 1; u[9248] = 1; u[9264] = 1; 
		u[9280] = 1; u[9296] = 1; u[9312] = 1; u[9328] = 1; u[9344] = 1; u[9360] = 1; u[9376] = 1; u[9392] = 1; u[9408] = 1; u[9424] = 1; 
		u[9440] = 1; u[9456] = 1; u[9472] = 1; u[9488] = 1; u[9504] = 1; u[9520] = 1; u[9536] = 1; u[9552] = 1; u[9568] = 1; u[9584] = 1; 
		u[9600] = 1; u[9616] = 1; u[9632] = 1; u[9648] = 1; u[9664] = 1; u[9680] = 1; u[9696] = 1; u[9712] = 1; u[9728] = 1; u[9744] = 1; 
		u[9760] = 1; u[9776] = 1; u[9792] = 1; u[9808] = 1; u[9824] = 1; u[9840] = 1; u[9856] = 1; u[9872] = 1; u[9888] = 1; u[9904] = 1; 
		u[9920] = 1; u[9936] = 1; u[9952] = 1; u[9968] = 1; u[9984] = 1; u[10000] = 1; u[10016] = 1; u[10032] = 1; u[10048] = 1; u[10064] = 1; 
		u[10080] = 1; u[10096] = 1; u[10112] = 1; u[10128] = 1; u[10144] = 1; u[10160] = 1; u[10176] = 1; u[10192] = 1; u[10208] = 1; u[10224] = 1; 
		u[10240] = 1; u[10256] = 1; u[10272] = 1; u[10288] = 1; u[10304] = 1; u[10320] = 1; u[10336] = 1; u[10352] = 1; u[10368] = 1; u[10384] = 1; 
		u[10400] = 1; u[10416] = 1; u[10432] = 1; u[10448] = 1; u[10464] = 1; u[10480] = 1; u[10496] = 1; u[10512] = 1; u[10528] = 1; u[10544] = 1; 
		u[10560] = 1; u[10576] = 1; u[10592] = 1; u[10608] = 1; u[10624] = 1; u[10640] = 1; u[10656] = 1; u[10672] = 1; u[10688] = 1; u[10704] = 1; 
		u[10720] = 1; u[10736] = 1; u[10752] = 1; u[10768] = 1; u[10784] = 1; u[10800] = 1; u[10816] = 1; u[10832] = 1; u[10848] = 1; u[10864] = 1; 
		u[10880] = 1; u[10896] = 1; u[10912] = 1; u[10928] = 1; u[10944] = 1; u[10960] = 1; u[10976] = 1; u[10992] = 1; u[11008] = 1; u[11024] = 1; 
		u[11040] = 1; u[11056] = 1; u[11072] = 1; u[11088] = 1; u[11104] = 1; u[11120] = 1; u[11136] = 1; u[11152] = 1; u[11168] = 1; u[11184] = 1; 
		u[11200] = 1; u[11216] = 1; u[11232] = 1; u[11248] = 1; u[11264] = 1; u[11280] = 1; u[11296] = 1; u[11312] = 1; u[11328] = 1; u[11344] = 1; 
		u[11360] = 1; u[11376] = 1; u[11392] = 1; u[11408] = 1; u[11424] = 1; u[11440] = 1; u[11456] = 1; u[11472] = 1; u[11488] = 1; u[11504] = 1; 
		u[11520] = 1; u[11536] = 1; u[11552] = 1; u[11568] = 1; u[11584] = 1; u[11600] = 1; u[11616] = 1; u[11632] = 1; u[11648] = 1; u[11664] = 1; 
		u[11680] = 1; u[11696] = 1; u[11712] = 1; u[11728] = 1; u[11744] = 1; u[11760] = 1; u[11776] = 1; u[11792] = 1; u[11808] = 1; u[11824] = 1; 
		u[11840] = 1; u[11856] = 1; u[11872] = 1; u[11888] = 1; u[11904] = 1; u[11920] = 1; u[11936] = 1; u[11952] = 1; u[11968] = 1; u[11984] = 1; 
		u[12000] = 1; u[12016] = 1; u[12032] = 1; u[12048] = 1; u[12064] = 1; u[12080] = 1; u[12096] = 1; u[12112] = 1; u[12128] = 1; u[12144] = 1; 
		u[12160] = 1; u[12176] = 1; u[12192] = 1; u[12208] = 1; u[12224] = 1; u[12240] = 1; u[12256] = 1; u[12272] = 1; u[12288] = 1; u[12304] = 1; 
		u[12320] = 1; u[12336] = 1; u[12352] = 1; u[12368] = 1; u[12384] = 1; u[12400] = 1; u[12416] = 1; u[12432] = 1; u[12448] = 1; u[12464] = 1; 
		u[12480] = 1; u[12496] = 1; u[12512] = 1; u[12528] = 1; u[12544] = 1; u[12560] = 1; u[12576] = 1; u[12592] = 1; u[12608] = 1; u[12624] = 1; 
		u[12640] = 1; u[12656] = 1; u[12672] = 1; u[12688] = 1; u[12704] = 1; u[12720] = 1; u[12736] = 1; u[12752] = 1; u[12768] = 1; u[12784] = 1; 
		u[12800] = 1; u[12816] = 1; u[12832] = 1; u[12848] = 1; u[12864] = 1; u[12880] = 1; u[12896] = 1; u[12912] = 1; u[12928] = 1; u[12944] = 1; 
		u[12960] = 1; u[12976] = 1; u[12992] = 1; u[13008] = 1; u[13024] = 1; u[13040] = 1; u[13056] = 1; u[13072] = 1; u[13088] = 1; u[13104] = 1; 
		u[13120] = 1; u[13136] = 1; u[13152] = 1; u[13168] = 1; u[13184] = 1; u[13200] = 1; u[13216] = 1; u[13232] = 1; u[13248] = 1; u[13264] = 1; 
		u[13280] = 1; u[13296] = 1; u[13312] = 1; u[13328] = 1; u[13344] = 1; u[13360] = 1; u[13376] = 1; u[13392] = 1; u[13408] = 1; u[13424] = 1; 
		u[13440] = 1; u[13456] = 1; u[13472] = 1; u[13488] = 1; u[13504] = 1; u[13520] = 1; u[13536] = 1; u[13552] = 1; u[13568] = 1; u[13584] = 1; 
		u[13600] = 1; u[13616] = 1; u[13632] = 1; u[13648] = 1; u[13664] = 1; u[13680] = 1; u[13696] = 1; u[13712] = 1; u[13728] = 1; u[13744] = 1; 
		u[13760] = 1; u[13776] = 1; u[13792] = 1; u[13808] = 1; u[13824] = 1; u[13840] = 1; u[13856] = 1; u[13872] = 1; u[13888] = 1; u[13904] = 1; 
		u[13920] = 1; u[13936] = 1; u[13952] = 1; u[13968] = 1; u[13984] = 1; u[14000] = 1; u[14016] = 1; u[14032] = 1; u[14048] = 1; u[14064] = 1; 
		u[14080] = 1; u[14096] = 1; u[14112] = 1; u[14128] = 1; u[14144] = 1; u[14160] = 1; u[14176] = 1; u[14192] = 1; u[14208] = 1; u[14224] = 1; 
		u[14240] = 1; u[14256] = 1; u[14272] = 1; u[14288] = 1; u[14304] = 1; u[14320] = 1; u[14336] = 1; u[14352] = 1; u[14368] = 1; u[14384] = 1; 
		u[14400] = 1; u[14416] = 1; u[14432] = 1; u[14448] = 1; u[14464] = 1; u[14480] = 1; u[14496] = 1; u[14512] = 1; u[14528] = 1; u[14544] = 1; 
		u[14560] = 1; u[14576] = 1; u[14592] = 1; u[14608] = 1; u[14624] = 1; u[14640] = 1; u[14656] = 1; u[14672] = 1; u[14688] = 1; u[14704] = 1; 
		u[14720] = 1; u[14736] = 1; u[14752] = 1; u[14768] = 1; u[14784] = 1; u[14800] = 1; u[14816] = 1; u[14832] = 1; u[14848] = 1; u[14864] = 1; 
		u[14880] = 1; u[14896] = 1; u[14912] = 1; u[14928] = 1; u[14944] = 1; u[14960] = 1; u[14976] = 1; u[14992] = 1; u[15008] = 1; u[15024] = 1; 
		u[15040] = 1; u[15056] = 1; u[15072] = 1; u[15088] = 1; u[15104] = 1; u[15120] = 1; u[15136] = 1; u[15152] = 1; u[15168] = 1; u[15184] = 1; 
		u[15200] = 1; u[15216] = 1; u[15232] = 1; u[15248] = 1; u[15264] = 1; u[15280] = 1; u[15296] = 1; u[15312] = 1; u[15328] = 1; u[15344] = 1; 
		u[15360] = 1; u[15376] = 1; u[15392] = 1; u[15408] = 1; u[15424] = 1; u[15440] = 1; u[15456] = 1; u[15472] = 1; u[15488] = 1; u[15504] = 1; 
		u[15520] = 1; u[15536] = 1; u[15552] = 1; u[15568] = 1; u[15584] = 1; u[15600] = 1; u[15616] = 1; u[15632] = 1; u[15648] = 1; u[15664] = 1; 
		u[15680] = 1; u[15696] = 1; u[15712] = 1; u[15728] = 1; u[15744] = 1; u[15760] = 1; u[15776] = 1; u[15792] = 1; u[15808] = 1; u[15824] = 1; 
		u[15840] = 1; u[15856] = 1; u[15872] = 1; u[15888] = 1; u[15904] = 1; u[15920] = 1; u[15936] = 1; u[15952] = 1; u[15968] = 1; u[15984] = 1; 

		t1 = ccnt_read();

		float temp = (t1 - t0 - overhead); 
		sum_t += temp;
		u += 15984 + 16;
		n += step;		

		if (u >= &v[SIZE - 15984])
			u = v;
	
		if(temp < 0) printf("negative!");

		result[cnt++] = temp;

		if(min > temp) {
			min = temp;
		} 	

		if(max < temp) {
			max = temp;
		}	
	}

	for(int i = 0; i < cnt ; ++i) {
		for(int j = i; j < cnt ; ++j) {
			if(result[i] > result[j]) {
				float temp = result[i];
				result[i] = result[j];
				result[j] = temp;	
			}
		}

		std += pow((result[i] - mean), 2);
	}

	median = result[cnt/2];
	mean = (sum_t/cnt);
	std /= (cnt);	
	
	printf("mean : %f \n", mean);
	printf("median : %f \n", median);
	printf("max : %f \n", max);
	printf("min : %f \n", min);
	printf("std : %f \n", sqrt(std));


	//printf("%d, %d, %lld\n", (int)sum_t, (int)(sum_t / 1188000), sum_tt);
	printf("BW_WT_AVG\t%d(MB/S)\t%d\t%d\n", (int)((n * sizeof(int)) / (0.00000000143*sum_t*1024*1024)), sizeof(int)*SIZE, STRIDE);

	free(v);
}

